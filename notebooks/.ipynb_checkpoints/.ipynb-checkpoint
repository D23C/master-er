{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Ciclo de Rankine\n",
    "\n",
    "Estudio de un ciclo ideal de Rankine básico (sin recalentamiento). Datos de partida:\n",
    "\n",
    "* Temperatura del agua a la entrada del boiler: 26,85 ºC (300 K)\n",
    "* Temperatura del vapor a la entrada de la turbina: 626,85 ºC (900 K)\n",
    "* Presión a la entrada del boiler: 10 kPa\n",
    "* Presión a la entrada de la turbina: 10 MPa\n",
    "* Flujo de vapor: 20 kg/s\n",
    "\n",
    "Eficiencias de los equipos: como es el ciclo ideal, de momento las dejamos a 1. Pero dejaremos preparado el código para añadir las eficiencias más tarde."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Importamos los paquetes necesarios\n",
    "\n",
    "import cantera as ct\n",
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Funciones de visualización\n",
    "\n",
    "def plot_water_curve(w):\n",
    "    Ts = np.linspace(274, w.critical_temperature-0.1, 1000)\n",
    "    Xs = 0\n",
    "    T_line = []\n",
    "    s_line = []\n",
    "    for i in Ts:\n",
    "        w.TX = i, 0.0\n",
    "        T_line.append(w.T)\n",
    "        s_line.append(w.s)\n",
    "\n",
    "    Ts2 = np.linspace(w.critical_temperature-0.1, 274, 1000)\n",
    "    Xs2 = 1\n",
    "    T2_line = []\n",
    "    s2_line = []\n",
    "    for i in Ts:\n",
    "        w.TX = i, 1.0\n",
    "        T2_line.append(w.T)\n",
    "        s2_line.append(w.s)\n",
    "    \n",
    "    plt.plot(s_line, T_line, color='blue')\n",
    "    plt.plot(s2_line, T2_line, color='blue')\n",
    "    plt.ylim(0, 1000)\n",
    "\n",
    "    \n",
    "def plot_isobar(P):\n",
    "    Ts3 = np.linspace(w.critical_temperature-0.1, 650, 1000)\n",
    "    S = np.linspace(3900, 11900, 1000)\n",
    "    T3_line = []\n",
    "    s3_line = []\n",
    "    for i in S:\n",
    "        w.SP = i, P\n",
    "        T3_line.append(w.T)\n",
    "        s3_line.append(w.s)\n",
    "    \n",
    "    plt.plot(s3_line, T3_line, color='red')\n",
    "    \n",
    "def plot_estado(estado, offset=10):\n",
    "    t = estado[-2]\n",
    "    s = estado[-1]\n",
    "    plt.scatter(s, t, c='green', s=20)\n",
    "    plt.annotate(str(estado[0]), xy=(s, t), xytext=(s+offset, t+offset))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 51,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Funciones del ciclo\n",
    "\n",
    "def bomba(fluido, presion_final, rendimiento):\n",
    "    \"\"\"Compresión adiabática hasta presión final con una bomba con rendimiento\"\"\"\n",
    "    h0 = fluido.h\n",
    "    s0 = fluido.s\n",
    "    fluido.SP = s0, presion_final\n",
    "    h1s = fluido.h\n",
    "    trabajo_isentropico = h1s - h0\n",
    "    trabajo_real = trabajo_isentropico / rendimiento\n",
    "    print('Trabajo isentropico (bomba): {:.3f} J/kg, Trabajo real (bomba): {:.3f} J/kg'.format(trabajo_isentropico, trabajo_real))\n",
    "    h1 = h0 + trabajo_real\n",
    "    fluido.HP = h1, presion_final\n",
    "    return trabajo_real\n",
    "\n",
    "def turbina(fluido, presion_final, rendimiento):\n",
    "    \"\"\"Expansión adiabática hasta presion_final, con una turbina con rendimiento\"\"\"\n",
    "    h0 = fluido.h\n",
    "    s0 = fluido.s\n",
    "    fluido.SP = s0, presion_final\n",
    "    h1s = fluido.h\n",
    "    trabajo_isentropico = h0 - h1s\n",
    "    trabajo_real = trabajo_isentropico * rendimiento\n",
    "    print('Trabajo isentropico (turbina): {:.3f} J/kg, Trabajo real (turbina): {:.3f} J/kg'.format(trabajo_isentropico, trabajo_real))\n",
    "    h1 = h0 - trabajo_real\n",
    "    fluido.HP = h1, presion_final\n",
    "    return trabajo_real\n",
    "\n",
    "def boiler(w, T_final, presion):\n",
    "    \"\"\"Calentamiento del fluido hasta temperatura T_final a presión constante\"\"\"\n",
    "    h_pre = w.h\n",
    "    w.TP = T_final, presion\n",
    "    h_post = w.h\n",
    "    calor_in = h_post - h_pre\n",
    "    print('Calor (boiler):  {:.3f} J/kg'.format(calor_in))\n",
    "    return calor_in\n",
    "\n",
    "def condensador(w, T_final):\n",
    "    \"\"\"Disipación de calor hasta que la fracción sea 0 y a una temperatura T_final\"\"\"\n",
    "    h_pre = w.h\n",
    "    w.TX = T_final, 0.0\n",
    "    h_post = w.h\n",
    "    calor_out = h_pre - h_post\n",
    "    print('Calor disipado (condensador): {:.3f} J/kg'.format(calor_out))\n",
    "    return calor_out\n",
    "\n",
    "def entalpia(fluido):\n",
    "    return fluido.h\n",
    "\n",
    "def print_estados(fluido, id_estado):\n",
    "    h = fluido.h\n",
    "    p = fluido.P\n",
    "    T = fluido.T\n",
    "    s = fluido.s\n",
    "    print('Estado #{} --> h:{:.3f} J/kg, p:{:.3f} Pa, T:{:.2f} K, s:{:.2f} J/kg·K'.format(id_estado, h, p, T, s))\n",
    "    return id_estado, h, p, T, s\n",
    "\n",
    "def eficiencia_ciclo(calor_in, trabajo_turbina, trabajo_bomba):\n",
    "    eficiencia = (trabajo_turbina - trabajo_bomba) / calor_in\n",
    "    print('Eficiencia del ciclo: {:.2f}'.format(eficiencia))\n",
    "    return eficiencia\n",
    "\n",
    "def potencia_ciclo(flujo_vapor, trabajo_turbina, trabajo_bomba):\n",
    "    trabajo_neto = trabajo_turbina - trabajo_bomba\n",
    "    potencia = trabajo_neto * flujo_vapor / 1000\n",
    "    print('Potencia del ciclo: {:.2f} kW'.format(potencia))\n",
    "    return potencia"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 52,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Estado #1 --> h:-15858194.325 J/kg, p:10000.000 Pa, T:300.00 K, s:3913.20 J/kg·K\n",
      "Trabajo isentropico (bomba): 10002.004 J/kg, Trabajo real (bomba): 10002.004 J/kg\n",
      "Estado #2 --> h:-15848192.321 J/kg, p:10000000.010 Pa, T:300.20 K, s:3913.20 J/kg·K\n",
      "Calor (boiler):  3568890.793 J/kg\n",
      "Estado #3 --> h:-12279301.527 J/kg, p:10000000.002 Pa, T:900.00 K, s:10497.45 J/kg·K\n",
      "Trabajo isentropico (turbina): 1480961.574 J/kg, Trabajo real (turbina): 1480961.574 J/kg\n",
      "Estado #4 --> h:-13760263.101 J/kg, p:10000.000 Pa, T:319.00 K, s:10497.45 J/kg·K\n",
      "Calor disipado (condensador): 2097937.184 J/kg\n",
      "Eficiencia del ciclo: 0.41\n",
      "Potencia del ciclo: 29419.19 kW\n"
     ]
    }
   ],
   "source": [
    "# Condiciones de partida\n",
    "T_inicial = 300\n",
    "P_inicial = 10e3\n",
    "T_turbina = 900\n",
    "P_salida = 10e6\n",
    "flujo_vapor = 20\n",
    "\n",
    "# Definición del fluido\n",
    "w = ct.Water()\n",
    "\n",
    "# Parámetros de los equipos\n",
    "rendimiento_bomba = 1.0\n",
    "rendimiento_turbina = 1.0\n",
    "\n",
    "# Estado 1 (antes de entrar en la bomba/salida del condensador)\n",
    "w.TP = T_inicial, P_inicial\n",
    "h1 = entalpia(w)\n",
    "estado1 = print_estados(w, 1)\n",
    "\n",
    "# Bomba\n",
    "trabajo_bomba = bomba(w, P_salida, rendimiento_bomba)\n",
    "\n",
    "# Estado 2 (a la salida de la bomba/entrada al boiler)\n",
    "h2 = entalpia(w)\n",
    "estado2 = print_estados(w, 2)\n",
    "\n",
    "# Boiler\n",
    "calor_introducido = boiler(w, T_turbina, P_salida)\n",
    "\n",
    "# Estado 3 (a la salida del boiler/entrada de la turbina)\n",
    "h3 = entalpia(w)\n",
    "estado3 = print_estados(w, 3)\n",
    "\n",
    "# Turbina\n",
    "trabajo_turbina = turbina(w, P_inicial, rendimiento_turbina)\n",
    "\n",
    "# Estado 4 (a la salida de la turbina/entrada al condensador)\n",
    "h4 = entalpia(w)\n",
    "estado4 = print_estados(w, 4)\n",
    "\n",
    "# Condensador\n",
    "calor_disipado = condensador(w, T_inicial)\n",
    "\n",
    "# Eficiencia y potencia del ciclo\n",
    "eficiencia = eficiencia_ciclo(calor_introducido, trabajo_turbina, trabajo_bomba)\n",
    "potencia = potencia_ciclo(flujo_vapor, trabajo_turbina, trabajo_bomba)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 50,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Visualización\n",
    "\n",
    "plot_water_curve(w)\n",
    "plot_isobar(P_inicial)\n",
    "plot_isobar(P_salida)\n",
    "\n",
    "plot_estado(estado1, offset=-70)\n",
    "plot_estado(estado2, offset=30)\n",
    "plot_estado(estado3, offset=-70)\n",
    "plot_estado(estado4, offset=30)\n",
    "\n",
    "plt.show()"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.1"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
